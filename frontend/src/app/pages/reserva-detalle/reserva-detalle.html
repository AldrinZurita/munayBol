<div class="reserva-detalle-container" *ngIf="!loading && reserva">
  <div class="header">
    <a class="btn-volver" routerLink="/perfil">
  ‚Üê Volver a Mi Perfil
</a>

    <h1 class="titulo">Detalles de Reserva</h1>
    <div class="reserva-id">Reserva #BK{{ reserva.id_reserva.toString().padStart(3, '0') }}</div>
    <span class="badge-estado" [class.confirmada]="obtenerEstadoReserva() === 'Confirmado'">
      {{ obtenerEstadoReserva() }}
    </span>
  </div>

  <div class="contenido">
    <!-- Informaci√≥n General -->
    <div class="card">
      <h2 class="card-titulo">Informaci√≥n General</h2>
      <div class="info-item">
        <div class="info-label">Habitaci√≥n en "{{ reserva.hotel_nombre || 'Cargando...' }}"</div>
        <div class="info-location">
  <span class="icon-location">üìç</span> {{ reserva.ubicacion_hotel || 'Ubicaci√≥n no disponible' }}
</div>

      </div>
      <div class="info-item">
        <div class="info-label">Hotel: {{ reserva.hotel_nombre || 'Cargando...' }}</div>
        <div class="info-sublabel">Tipo: Habitaci√≥n</div>
      </div>
      
      <div class="fechas-container">
        <div class="fecha-box">
          <div class="fecha-label">Check-in</div>
          <div class="fecha-icon">üìÖ</div>
          <div class="fecha-valor">{{ formatearFechaCorta(reserva.fecha_reserva) }}</div>
          <div class="fecha-dia">{{ formatearFecha(reserva.fecha_reserva) }}</div>
        </div>
        <div class="fecha-box">
          <div class="fecha-label">Check-out</div>
          <div class="fecha-icon">üìÖ</div>
          <div class="fecha-valor">{{ formatearFechaCorta(reserva.fecha_caducidad) }}</div>
          <div class="fecha-dia">{{ formatearFecha(reserva.fecha_caducidad) }}</div>
        </div>
      </div>

      <div class="info-item">
        <span class="icon-huespedes">üë•</span>
        <span class="info-valor">{{ reserva.habitacion_huespedes || 2 }} hu√©spedes</span>
      </div>
      <div class="info-item">
        <div class="info-label">Duraci√≥n: {{ calcularNoches() }} noches</div>
      </div>
    </div>

    <!-- Resumen de Precio -->
    <div class="card card-precio">
  <h2 class="card-titulo">Resumen de Precio</h2>

  <div class="precio-item">
    <span class="precio-label">Precio por noche</span>
    <span class="precio-valor">{{ reserva.habitacion_precio || 398.75 }} BOB</span>
  </div>

  <div class="precio-item">
    <span class="precio-label">Subtotal ({{ calcularNoches() }} noches)</span>
    <span class="precio-valor">{{ calcularSubtotal() }} BOB</span>
  </div>

  <div class="precio-item">
    <span class="precio-label">IVA (13%)</span>
    <span class="precio-valor">{{ calcularIVA() }} BOB</span>
  </div>

  <div class="precio-total">
    <span class="total-label">Total</span>
    <span class="total-valor">{{ calcularTotal() }} BOB</span>
  </div>
</div>


    <!-- Informaci√≥n de Reserva -->
    <div class="card">
      <h2 class="card-titulo">Informaci√≥n de Reserva</h2>
      <div class="info-item">
        <div class="info-label">Fecha de reserva</div>
        <div class="info-valor">{{ formatearFechaCorta(reserva.fecha_creacion) }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">M√©todo de pago</div>
        <div class="info-valor">
          üí≥ Tarjeta de cr√©dito {{ ocultarNumeroTarjeta(reserva.pago_info?.cod_seguridad?.toString() || '1234') }}
        </div>
      </div>
    </div>

    <!-- Informaci√≥n de Contacto -->
    <div class="card">
      <h2 class="card-titulo">Informaci√≥n de Contacto</h2>
      <div class="info-item">
        <div class="info-label">Tel√©fono de emergencia</div>
        <div class="info-valor">
          üìû +591 2 234-5678
        </div>
      </div>
      <div class="info-item">
        <div class="info-label">Email de soporte</div>
        <div class="info-valor">
          ‚úâÔ∏è soporte@munaybol.com
        </div>
      </div>
    </div>

    <!-- Pol√≠tica de Cancelaci√≥n -->
    <div class="card card-politica">
      <h2 class="card-titulo">Pol√≠tica de Cancelaci√≥n</h2>
      <div class="politica-item">
        <span class="politica-icono">‚ö†Ô∏è</span>
        <div class="politica-contenido">
          <div class="politica-titulo">Cancelaci√≥n gratuita</div>
          <div class="politica-descripcion">Puedes cancelar sin costo hasta 48 horas antes de la fecha de check-in.</div>
        </div>
      </div>
      <div class="politica-item">
        <span class="politica-icono">‚ö†Ô∏è</span>
        <div class="politica-contenido">
          <div class="politica-titulo">Cancelaci√≥n tard√≠a</div>
          <div class="politica-descripcion">Las cancelaciones dentro de las 48 horas est√°n sujetas a penalizaci√≥n del 50%.</div>
        </div>
      </div>
    </div>

    <!-- Acciones -->
    <div class="acciones">
      <button class="btn btn-modificar" (click)="modificarReserva()">
        Modificar Reserva
      </button>
      <button class="btn btn-cancelar" (click)="cancelarReserva()">
        Cancelar Reserva
      </button>
    </div>
  </div>
</div>

<div class="loading-container" *ngIf="loading">
  <div class="spinner"></div>
  <p>Cargando detalles de la reserva...</p>
</div>

<div class="error-container" *ngIf="error && !loading">
  <p>{{ error }}</p>
  <button class="btn-volver" (click)="volverAMisReservas()">Volver</button>
</div>
